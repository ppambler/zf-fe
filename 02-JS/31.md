| ✍️ Tangxt | ⏳ 2020-06-29 | 🏷️ DOM 操作 |

# 31-DOM 操作-scroll 系列（回到顶部案例）

## ★offsetWidth & offsetHeight

``` js
//  -> 在 CLIENT 的基础上加上 BORDER == 盒子本身的宽高
box.offsetWidth
box.offsetHeight
```

``` css
.box {
  width: 300px;
  height: 300px;
  padding: 20px;
  border: 10px solid yellow;
  line-height: 32px;
}
```

如果盒子模型是 `border-box` ，那么 `width` 值是多少， `offsetWidth` 值也是多少，同理 `offsetHeight` 也是如此！如盒子是 `300*300` ，那么 `offsetWidth` 是 `300` ， `offsetHeight` 也是 `300` 

如果盒子模型是 `content-box` ，那么 `offsetWidth` 就是 `360 = 300 + 20 * 2 + 10 * 2` ， `offsetHeight` 也是 `360` 

一些特点：

1. 同 `client` 一样，内容溢出咩影响，毕竟这是基于 `client` 的
2. 同 `client` 一样，也是 `Number` 类型的整数值
3. 同 `client` 一样，也会四拾伍入

## ★scrollWidth & scrollHeight

### ◇在没有内容溢出的情况下，获取的结果和 CLIENT 是一样的

![scrollWidth & scrollHeight](assets/img/2020-06-30-09-03-06.png)

``` js
box.scrollWidth
box.scrollHeight
```

> 图中的盒子模型是 `border-box` 

`scroll` 有 滚动的意思，所以测试一下：「内容溢出」+「添加滚动条」

### ◇在有内容溢出的情况下，获取的结果约等于真实内容的宽高（上/左 PADDING + 真实内容的高度/宽度）

为什么说「约等于」呢？

1. 不同浏览器获取的结果不尽相同 -> 浏览器之间存在各自的默认样式 -> 所以可能会有几像素的误差
2. 设置 `overflow` 属性值对最后的结果也会产生一定的影响

测试：

``` css
.box {
  box-sizing: border-box;
  width: 300px;
  height: 300px;
  padding: 20px;
  border: 10px solid yellow;
  /* 两种情况下：决定有无溢出 -> 注释掉无溢出，没有注释掉有溢出 */
  line-height: 64px;
  /* 三种情况：不写 overflow 属性、scroll、auto */
  overflow: auto;
}
```

1、内容只有溢出，没有设置 `overflow` 属性

![scrollHeight](assets/img/2020-06-30-09-17-42.png)

---

这一坨内容是基于后边的理解才写下来的（从上到下阅读时，请忽略这段，看完后边的内容才看这段，不然，你是不知道在下文的几点里边，我为何会产生一些「不知道如何计算」的疑问）：

> ps：上 padding 非 padding 值！只是简单理解成「文字高度+空白高度」
> 
> 我设置了行高是`64px`，总共有`6`行，得到`384px`，末尾一行去掉`(64-16)/2 = 24px`（溢出的缘故，不溢出不用削掉），所以文字高度是`384-24=360`，而`padding-top`是`20px`，所以最终结果是`380px`，然而`scrollHeight`是`382`，根据不同字体存在先天性的「字体度量」，所以文字内容的实际高度是`362px`，而不是`360px`

关于字体度量可以看一下这个：

➹：[深入理解 CSS：字体度量、line-height 和 vertical-align - 知乎](https://zhuanlan.zhihu.com/p/25808995)

---

2、内容有溢出，而且设置了 `overflow:hidden` 

![hidden](assets/img/2020-06-30-09-29-42.png)

3、内容有溢出，而且设置了 `overflow:scroll` 

`overflow: scroll` 这个属性，不怎么常用，因为内容如果是没有溢出的，它也会加上滚动条，如这样：

![没有溢出的 scroll](assets/img/2020-06-30-09-34-51.png)

> 滚动条不是内容的一部分

如果有溢出呢？

![有溢出的 scroll](assets/img/2020-06-30-09-37-10.png)

4、内容有溢出，而且设置了 `overflow:auto` 

一般我们在实际开发中用的是 `auto` ，而不是 `scroll` ，因为后者即便内容没有溢出，也会叫滚动条，而前者只有在内容溢出的时候才会加！

内容无溢出（有无 `overflow:auto` 都一样）：

![内容无溢出](assets/img/2020-06-30-09-42-23.png)

内容有溢出：

![内容有溢出](assets/img/2020-06-30-09-46-45.png)

我似乎知道这个 `488` 是怎么来的了 -> 由于多了一个垂直滚动条，这意味着一行的文字数变少了，本来在咩有这个滚动条的时候，一行有 15 个，可现在只有 13 个，而这意味着，内容的高度增大了！ -> 本来是 6 行，现在是 7 行

经过我粗略计算，488 是这么来的：

文字内容高度+上下 padding：

![文字内容高度+上下 padding](assets/img/2020-06-30-10-43-32.png)

形象点来说：

![卫生纸与文字内容](assets/img/2020-06-30-10-55-16.png)

我把`content`看成是「卫生纸」，或者你也可以把`scrollHeight`看成是「卫生纸」

![scroll](assets/img/2020-06-30-12-59-47.png)

> 对词源发散一下去理解一些东西……

### ◇了解这俩属性有啥用？

1、如何获取一个页面的真实的高度？

我们通过`clientHeight`，可以获得一屏的高度，但溢出的内容（相对于一屏幕的溢出），那我们该如何获取呢？

也就是说，如何获取「一屏高度+溢出内容高度 = 页面的真实高度」？

![页面的真实高度](assets/img/2020-06-30-12-13-49.png)

灰常简单：

``` js
//获取整个页面真实的高度
document.documentElement.scrollHeight || document.body.scrollHeight
```

## ★scrollTop & scrollLeft

### ◇概述

``` js
// 竖向滚动条卷去的高度
box.scrollTop

// 横向滚动条卷去的宽度
box.scrollLeft
```

测试：

![scropTop](assets/img/2020-06-30-14-14-56.png)

> 就像是一页纸的顶部，被切掉多少一样，或者被卷走了多少一样 -> 也可以把盒子当作是一个井盖，页面就是流动的河流……

![scrollTop 比喻](assets/img/2020-06-30-14-20-12.png)

---

Q：话说，scrollTop 的值是否有边界？即它是否有最小值和最大值？

- 边界值：
  - `Min = 0`
  - `Max = 整个的高度 scrollHeight - 一屏幕高度 clientHeight` -> 回到底部

``` js
// box.scrollTop = box.scrollHeight - box.clientHeight
208 = 488 - 280
```

为啥最大值的计算会这样呢？

![scrollTop 的最大值](assets/img/2020-06-30-14-30-31.png)

---

这两个属性的特别之处：

> 13 个盒子模型属性，只有这两个是“**可读写**”的属性（既可以获取也可以设置对应的值），其余的都是“只读”属性（不能设置值，只能获取）

如：

``` js
box.scrollTop=0;
```

> 这说白了，通过JS，更改`scrollTop`的值，可以让页面自己滚动到相应的位置去！ -> 很多博客文章都会有很多级标题的，如果你做了一个有关标题的目录树，那么你可以通过点击目录树到底任何一个标题 -> 这似乎是使用a标签的`#xxx`实现的…… -> 如果用`scrollTop`的话，应该是那些`返回顶部`的小按钮吧！

不管怎样，可以简单理解成这样：你的面前有一幢88层楼的高楼大厦，你进入电梯，你想到66层楼，你只需要点一下「66」这个按钮，就会把你送到66层楼 -> 把一幢楼看成是一张网页，把每一层楼看成是一个个标志……

简单用途：

- `scrollTop`的最小值：回到顶部
- `scrollTop`的最大值：来到底部

### ◇实现一个回到顶部的功能

需求：

> 滚动页面到一定程度的时候，就会出现一个「回到顶部」的按钮，点击该按钮，就可「回到顶部」

1、咩有动画的简易版回到顶部

Q：如何出现十屏？

``` css
html,body {
  height: 1000%;
}
```

一屏`100%`，十屏就是`1000%`

如果你还添加渐变色，你会看到一些还不错的效果 -> 图解CSS一书可以去看看！

Q：如何让按钮固定漂浮在某个位置？

固定定位

Q：超过几屏就出现「按钮」？

一般是2屏，当然，你需求是咋滴，就咋搞吧！

按钮在一屏的时候是`display:none`的，超过2屏之后，就`display:block`

Q：滚动姿势有？

1. 鼠标滑轮滚动
2. 摁住滚动条往下拖滚动
3. 按下方向键滚动
4. 按空格键滚动

---

2、有动画的回到顶部

什么叫有动画？就是「回到顶部」不是瞬间完成的，而是有某种舒适的速度才回到的顶部！

1. b站没有做动画
2. 京东、淘宝等有做动画

如何做动画？

1. 有固定步长的动画，即1s走xx米，不确定多少时间能走完
2. 在某个时间内走完的动画，即在10s内完成，不管你其中的速度是忽快忽慢，还是匀速，还是其它的速度曲线

总之，就是一一点走，至于这一点点是怎样的粒度，由你自己决定……

> 就像是你从1楼走到10层楼上的天台一样，你可以瞬移，瞬间到天台，而这是没有动画的 -> 你可以1步一个台阶，不确定多少时间能走到天台 -> 你可以前5层很慢的走，后5层极快的走，总之得在5min这一时刻刚好走上天台














