| ✍️ Tangxt | ⏳ 2020-07-01 | 🏷️ DOM 操作 |

# 32-DOM操作-offset系列（获取元素的偏移值）

## ★前言

回顾一下之前了解到的东西：

``` js
// 获取盒子可视区域的宽高（内容宽度+左右PADDING）
box.clientWidth
box.clientHeight

// 获取盒子左边框和上边框的大小
box.clientLeft
box.clientTop

// 在CLIENT的基础上加上BORDER == 盒子本身的宽高
box.offsetWidth
box.offsetHeight

// 在没有内容溢出的情况下，获取的结果和CLIENT是一样的
// 在有内容溢出的情况下，获取的结果约等于真实内容的宽高（上/左PADDING + 真实内容的高度/宽度）
box.scrollWidth
box.scrollHeight

// 竖向滚动条卷去的高度 -> 在13个属性中，只有该属性可读写，其余的只能读，不能写……
// 横向滚动条卷去的宽度
box.scrollTop
box.scrollLeft
```

## ★offsetParent & offsetTop & offsetLeft

``` js
box.offsetParent
box.offsetTop
box.offsetLeft
```

![父参照物](assets/img/2020-07-02-18-59-21.png)

* `offsetParent` ：获取它的父参照物（不一定是父元素）
  + 父参照物和它的父元素没有必然的联系，父参照物查找：同一个平面中，**最**外层元素是**所有后代元素**的父参照物，而基于 `position:relative/absolute/fixed` 可以让元素脱离文档流（一个新的平面），从而改变元素的父参照物
* `offsetTop` ：距离其父参照物的上偏移
* `offsetLeft` ：距离其父参照物的左偏移（当前元素的外边框到父参照物的里边框）

---

Q：参照物？

JS里边的参照物概念，与CSS里边用于定位的参照物概念是一致的！

在物理里边，我们知道运动是相对，如你在路边看到一辆巴士经过，那么巴士里边的人动了吗？

对于你而言，是动了

对于巴士里边的人来说，是静止的

在研究机械运动时，人们事先选定的、假设不动的，作为基准的物体叫做**参照物**。

注意：一般**不以研究对象为参照物**，选择不同的参照物来描述**同一个物体的运动状态**，可能得出不同结论，所以运动和静止都是相对的

如我们想要确定巴士里边的人的运动状态：

* 相较于路人而言，是运动的
* 相较于座位而言，是静止的

所以，在CSS的定位里边：

* 我们确定了研究对象 -> 要定位的盒子 -> 小盒子（ `box` ）
* 确定了参照物是谁 -> 静止的容器盒子 -> 大盒子（ `container` ）

``` 
body > container > box
```

默认所有的小盒子的参照物都是 `body` 元素，就像是我们通常以地面为参照物一样，即便参照物是可以任意选定的！

如果小盒子设置了绝对定位，那么默认情况下是相对于body元素定位的 -> 小盒子脱离文档流 -> 小盒子的外边框（左上角）会被吸附到body的内边框（左上角）

Q：如果父参照物有border呢？如有10px的边框，那么 `box` 的 `offsetLeft` 和 `offsetTop` 实际是多少？

![offsetLeft的特殊性](assets/img/2020-07-02-19-04-22.png)

Q：如果盒子绝对定位，脱离文档流，打算改变默认的父参照物，那么 `offsetLeft/Top` 的值是不是因此而改变呢？

![定位](assets/img/2020-07-02-19-16-13.png)

``` css
.container {
  position: relative;
  width: 500px;
  height: 500px;
  border: 10px solid yellowgreen;

}

.box {
  /* or relative */
  position: absolute;
  top: 20px;
  left: 20px;
  margin-left: 20px;
  /* 默认的content-box也是如此 */
  box-sizing: border-box;
  width: 300px;
  height: 300px;
  padding: 20px;
  border: 10px solid yellow;
  line-height: 32px;
  overflow: auto;
}
```

`box`绝对定位了，我们让父参照物为`container`，然而 **`offsetTop` 的计算规则发生了变化，即是`container`的内壁到`box`的外壁**，而`offsetLeft`依旧一样，即还是`container`的内壁到`box`的外壁

> 双重`relative`也是可以改变父参照物的，我一直以为只有「子绝父相」才会改变子的父参照物，没想到「子相父相」也行

Q：我们知道同一平面中，所有后代元素的父参照物是`body`元素，那么`body`元素的父参照物是谁？

``` js
document.body.offsetParent === null;
```

是`null`值啦！即「没有」……可以说`body`元素就是参照物的终点！


## ★总结


## ★Q&A

1）怎样才算脱离文档流？

有人说`relative`的元素没有脱离文档流，而有些人如周老师认为它是脱离文档流了！

➹：[css脱离文档流到底是什么意思，脱离文档流就不占据空间了吗？脱离文档流是不是指该元素从dom树中脱离？ - 知乎](https://www.zhihu.com/question/24529373)




