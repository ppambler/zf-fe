| âœï¸ Tangxt | â³ 2020-08-05 | ðŸ·ï¸ è®¾è®¡æ¨¡å¼ |

# 37-å‘å¸ƒè®¢é˜…è®¾è®¡æ¨¡å¼

## â˜…å‰è¨€

ä»ŽæœåŠ¡å™¨èŽ·å–æ•°æ®ï¼š

1. æ•°æ®åˆ†æž
2. æ•°æ®ç»‘å®š
3. DOM å…ƒç´ çš„ç›¸å…³æ“ä½œ
4. â€¦â€¦

å…ƒç´ ç›‘å¬ç”¨æˆ·è¡Œä¸ºï¼š

1. æŽ¥æ”¶åˆ°äº†ä¿¡å·
2. ä¿¡å·åˆ†æž
3. æ‰§è¡Œ callback
4. æ•°æ®ç»‘å®š
5. DOM å…ƒç´ çš„ç›¸å…³æ“ä½œ
6. â€¦â€¦

## â˜…æ˜¯ä»€ä¹ˆï¼Ÿ

1ï¼‰æ¦‚è¿°

> é€è¿‡äº‹ä»¶æ± æœºåˆ¶ï¼Œæ¥è®©ä½ äº†è§£ä»€ä¹ˆæ˜¯ã€Œå‘å¸ƒè®¢é˜…è®¾è®¡æ¨¡å¼ã€

æˆ‘ä»¬ä½¿ç”¨ jQuery çš„ ajax æ–¹æ³•ï¼Œæ¥å‘é€ ajax è¯·æ±‚ï¼š

``` js
$.ajax({
  url: '/api/v1/userlist',
  success: function(result) {
    fn1(result)
    fn2(result)
    fn3(result)
  }
})

function fn1() {}

function fn2() {}

function fn3() {}
```

ä¹Ÿå¯ä»¥ä½¿ç”¨ axiosï¼š

``` js
axios.get('/api/v1/userlist')
.then(res => {})
.catch((err) => {})
```

ä¹Ÿå¯ä»¥ä½¿ç”¨å‘å¸ƒè®¢é˜…è®¾è®¡æ¨¡å¼ï¼š

å…ˆè§„åˆ’å¥½æ‹¿åˆ°æ•°æ®ä¹‹åŽï¼Œåº”è¯¥è¦åšä»€ä¹ˆï¼š

æŠŠ callback æ‰”åˆ°ä¸€ä¸ªå®¹å™¨é‡Œè¾¹åŽ» -> `$on(fn1)`ã€`$on(fn2)` -> ä¹Ÿå¯ä»¥ç§»é™¤ callbackï¼ˆ`$off`ï¼‰

æ•°æ®æ‹¿åˆ°ä¹‹åŽï¼Œç›´æŽ¥å°±è¿™æ ·ï¼š

``` js
$.ajax({
  url: '/api/v1/userlist',
  success: function(result) {
    // ä¾æ¬¡æ‰§è¡Œå®¹å™¨é‡Œçš„æ–¹æ³•
    $emit(result)
  }
})
```

è¿™ç§å§¿åŠ¿æ¯”ä¼ ç»Ÿçš„`$.ajax()`è¦å¥½ï¼

---

å‘å¸ƒè®¢é˜…è®¾è®¡æ¨¡å¼çš„æ€æƒ³æ˜¯ï¼š

> äº‹å…ˆæŠŠè¦å¹²çš„äº‹ç»™è®¡åˆ’å¥½ï¼ˆæŠŠ`callback`æ‰”åˆ°ä¸€ä¸ªæ± å­é‡ŒåŽ»ï¼‰ï¼Œå½“åˆ°è¾¾æŒ‡å®šæ¡ä»¶çš„æ—¶å€™ï¼ˆ`ajax`è¯·æ±‚æˆåŠŸï¼Œå“åº”å›žæ¥æ•°æ®ï¼‰æˆ–è€…è¯´æŸç§ä¿¡å·æ¥äº†ï¼Œå°±ä¾æ¬¡æ‰§è¡Œå®¹å™¨é‡Œçš„æ–¹æ³•ï¼

è¿™åŒäº‹ä»¶æ± æœºåˆ¶ä¸€æ ·ï¼Œç›‘å¬äº‹ä»¶ï¼Œä¿¡å·æ¥äº†ï¼Œä¾æ¬¡æ‰§è¡Œäº‹ä»¶æ± é‡Œçš„`callback`

2ï¼‰æ˜¯ä»€ä¹ˆ

è®¤è¯†å®ƒï¼Œä½ å¾—çŸ¥é“è¿™ä¹ˆå‡ ä¸ªæ¦‚å¿µï¼š

1. è‡ªå®šä¹‰äº‹ä»¶æ±  -> ä¹Ÿå°±æ˜¯è‡ªå®šä¹‰çš„ä¸€ä¸ªå®¹å™¨ -> æ³¨æ„è¿™å¯ä¸æ˜¯æµè§ˆå™¨å†…ç½®çš„äº‹ä»¶å“ˆï¼

## â˜…å†™ä¸€ä¸ª

1ï¼‰ä¸ºå•¥è¦ç”¨é¢å‘å¯¹è±¡å§¿åŠ¿å°è£…æ’ä»¶ï¼Ÿ

2ï¼‰ES6 çš„ class è¯­æ³•ã€è£…é¥°å™¨

3ï¼‰å†™ä¸€ä¸ªä½“çŽ°å‘å¸ƒè®¢é˜…è®¾è®¡æ¨¡å¼æ€æƒ³çš„ä»£ç 

1. è‡ªæ‰§è¡Œå‡½æ•°
2. åˆ›å»º `Sub` -> å®šä¹‰åŽŸåž‹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰ã€ŒAPI æŽ¥å£ã€ -> `$pondã€$onã€$offã€$emit` -> è¿™äº› API çš„è®¾è®¡æ˜¯ä»¿ç…§ Vue çš„ eventBus
3. `new Sub` -> ä½¿ç”¨
